<?php

namespace App;
 
use Maatwebsite\Excel\Concerns\FromCollection;
use Maatwebsite\Excel\Concerns\Exportable;
use Maatwebsite\Excel\Concerns\WithHeadings;

class DataDump implements FromCollection, WithHeadings
{
    use Exportable;

    public function collection()
    {
    	$data = Patient::select(\DB::raw(
            "id, 
            anaesthetist, 
            tumoursite, 
            `procedure`,
            position,
            proceed,
            noproceed,
            age,
            weight,
            bmi,
            asa,
            cvs,
            ht,
            antiht,
            mi,
            stents,
            cva,
            lvef,
            `as`,
            valve,
            af,
            cardiomyopathy,
            othercvs,
            resp,
            asthma,
            copd,
            bronchiectasis,
            steroids,
            icu,
            control,
            pft,
            fev1,
            fvc,
            fevfvc,
            pefr,
            otherresp,
            aids,
            tumour,
            liver,
            ccf,
            pvd,
            cvd,
            dementia,
            tissue,
            pud,
            pulmonary,
            renal,
            hemiplegia,
            diabetes,
            leukaemia,
            lymphoma,
            charlson,
            tenyear,
            ecog,
            ppcardiac,
            ppresp,
            ppecg,
            ppbp,
            pppulse,
            pphb,
            ppwbc,
            ppurea,
            ppna,
            ppk,
            ppgcs,
            ppseverity,
            ppprocedures,
            ppbloodloss,
            ppsoiling,
            ppmalignancy,
            ppurgency,
            ppphysiology,
            ppopscore,
            ppmorbidity,
            ppmortality,
            tiva,
            artline,
            hfjvuse,
            frequency,
            drivingpressuremin,
            drivingpressuremax,
            fio2,
            meanpressuremin,
            meanpressuremax,
            etco2,
            minco2,
            maxco2,
            desat,
            lowestdesat,
            ippv,
            tolerance,
            satisfaction,
            extubated,
            destination,
            comments,
            los,
            discharge,
            unplannedicu,
            complication,
            haemothorax,
            ptx,
            cvsunstable,
            othercomplication,
            postopmorphine,
            postopmorphineamount,
            suppanalgesiatime,
            fucomplete,
            epic,
            sex
            "
        ))->get();
        return collect($data);
    }

    public function headings(): array
    {
        return [
            'Case#',
            'Anaesthetist',
            'Tumour Site',
            'Procedure',
            'Patient Position',
            'Appropriate for HFJV',
            'Reason for not proceeding',
            'Age',
            'Weight',
            'BMI',
            'ASA',
            'Cardiovascular Morbidity',
            'Hypertension',
            'No. of Anti-HTs',
            'Previous MI',
            'Cardiac Stents',
            'Previous CVA',
            'LVEF',
            'AS',
            'Valve Area/Gradient',
            'A Fib',
            'Cardiomyopathy',
            'Other Cardiac',
            'Respiratory Morbidity',
            'Asthma',
            'COPD',
            'Bronchiectasis',
            'Steroids',
            'Previous ICU Admission',
            'Disease well controlled',
            'PFTs',
            'FEV1',
            'FVC',
            'FEV1/FVC',
            'PEFR',
            'Other respiratory disease',
            'AIDS',
            'Solid Tumour',
            'Liver Disease',
            'CCF',
            'PVD',
            'CVD',
            'Dementia',
            'Connective Tissue Disease',
            'PUD',
            'Chronic Pulmonary Disease',
            'Moderate to Severe Renal Failure',
            'Hemiplegia',
            'Diabetes',
            'Leukaemia',
            'Lymphoma',
            'Charlson Score',
            '10 Year Survival %',
            'ECOG Performance Status',
            'PP Cardiac/CXR',
            'PP Resp/CXR',
            'PP ECG',
            'PP Systolic BP',
            'PP Pulse',
            'PP Hb',
            'PP WBC',
            'PP Urea',
            'PP Sodium',
            'PP Potassium',
            'PP GCS',
            'PP Operative Severity',
            'PP No. of procedures',
            'PP Blood loss',
            'PP Peritoneal Soiling',
            'PP Malignancy',
            'PP Urgency',
            'PP Physiology Score',
            'PP Operative Score',
            'PP Morbidity %',
            'PP Mortality %',
            'TIVA',
            'Arterial Line',
            'HFJV used',
            'Frequency',
            'Driving Pressure Min',
            'Driving Pressure Max',
            'FiO2',
            'Mean Pressure Min',
            'Mean Pressure Max',
            'ETCO2 Checks',
            'CO2 Min',
            'CO2 Max',
            'No. Desats < 92%',
            'Lowest Saturations',
            'Converted to IPPV',
            'Was IPPV better tolerated',
            'Satisfaction',
            'Extubated',
            'Post-op Destination',
            'Comments',
            'Length of Stay',
            'Discharge Status',
            'Unplanned ICU',
            'Rpt Procedure or Compx',
            'Haemothorax',
            'PTX requiring unplanned drainage',
            'Cardiovascular instability',
            'Other complication',
            'Morphine required post-procedure',
            'Amount of morphine',
            'Time to supplemental analgesia',
            'Follow up complete',
            'Epic Import',
            'Sex'
        ];
    }
}
